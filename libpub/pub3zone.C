#include "pub3zone.h"

namespace pub3 {

  //-----------------------------------------------------------------------

  bool
  zone_text_t::add (ptr<zone_t> z)
  {
    bool ret = true;
    str s = z->to_str ();

    if (!s) {
      ret = false;
    } else if (s.len ()) {
      _hold.push_back (s);
      _b << s;
    }

    return ret;
  }

  //-----------------------------------------------------------------------

  bool
  zone_html_t::add (ptr<zone_t> z)
  {
    zone_html_t *zh;

    if ((zh = z->zone_html ()) && 
	zh->preserve_white_space () == preserve_white_space ()) {
      _children += *zh->children ();
    } else if (!_children.size () || !_children.back ().add (z)) {
      _childen.push_back (z);
    }
    return true;
  }
  
  //-----------------------------------------------------------------------

  ptr<zone_html_t> zone_html_t::alloc (int pws)
  { return New refcounted<zone_html_t> (pws) }

  //-----------------------------------------------------------------------

  ptr<zone_text_t> zone_text_t::alloc ()
  { return New refcounted<zone_text_t> (); }

  //-----------------------------------------------------------------------

  ptr<zone_inline_expr_t> zone_inline_expr_t::alloc ()
  { return New refcounted<zone_inline_expr_t> (); }

  //-----------------------------------------------------------------------
  //-----------------------------------------------------------------------
  //-----------------------------------------------------------------------
  //-----------------------------------------------------------------------
  //-----------------------------------------------------------------------
  //-----------------------------------------------------------------------
  //-----------------------------------------------------------------------
  //-----------------------------------------------------------------------
  //-----------------------------------------------------------------------

};

